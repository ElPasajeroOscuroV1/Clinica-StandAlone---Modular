<div class="doctors-container">
  <div class="doctors-header">
    <div class="header-content">
      <div class="header-icon">üë®‚Äç‚öïÔ∏è</div>
      <div class="header-text">
        <h1>Gesti√≥n de M√©dicos</h1>
        <p>Administra el registro y configuraci√≥n de m√©dicos en tu cl√≠nica</p>
      </div>
    </div>
  </div>

  <div class="form-section">
    <div class="form-header">
      <h2>{{ isEditing ? 'Editar M√©dico' : 'Registrar Nuevo M√©dico' }}</h2>
      <div class="form-status" *ngIf="doctorForm.valid">
        <small class="text-success">‚úì Formulario completo</small>
      </div>
    </div>

    <form [formGroup]="doctorForm" (ngSubmit)="onSubmit()" class="doctor-form">
      <div class="form-row">
        <div class="form-group">
          <label for="name" class="form-label">
            <i class="icon-user"></i> Nombre Completo
          </label>
          <input type="text" class="form-control" id="name" formControlName="name"
                 placeholder="Ingresa el nombre completo" />
          <div class="invalid-feedback" *ngIf="doctorForm.get('name')?.invalid && doctorForm.get('name')?.touched">
            El nombre es obligatorio
          </div>
        </div>

        <div class="form-group">
          <label for="specialty" class="form-label">
            <i class="icon-stethoscope"></i> Especialidad
          </label>
          <input type="text" class="form-control" id="specialty" formControlName="specialty"
                 placeholder="Ej: Cardiolog√≠a, Pediatr√≠a" />
          <div class="invalid-feedback" *ngIf="doctorForm.get('specialty')?.invalid && doctorForm.get('specialty')?.touched">
            La especialidad es obligatoria
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="email" class="form-label">
            <i class="icon-mail"></i> Correo Electr√≥nico
          </label>
          <input type="email" class="form-control" id="email" formControlName="email"
                 placeholder="doctor@clinica.com" />
          <div class="invalid-feedback" *ngIf="doctorForm.get('email')?.invalid && doctorForm.get('email')?.touched">
            <span *ngIf="doctorForm.get('email')?.errors?.['required']">El email es obligatorio</span>
            <span *ngIf="doctorForm.get('email')?.errors?.['email']">Formato de email inv√°lido</span>
          </div>
        </div>

        <div class="form-group">
          <label for="phone" class="form-label">
            <i class="icon-phone"></i> Tel√©fono
          </label>
          <input type="text" class="form-control" id="phone" formControlName="phone"
                 placeholder="+591 12345678" />
          <div class="invalid-feedback" *ngIf="doctorForm.get('phone')?.invalid && doctorForm.get('phone')?.touched">
            El tel√©fono es obligatorio
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="password" class="form-label">
            <i class="icon-lock"></i> Contrase√±a
          </label>
          <input type="password" class="form-control" id="password" formControlName="password"
                 placeholder="Contrase√±a segura" />
          <div class="invalid-feedback" *ngIf="doctorForm.get('password')?.invalid && doctorForm.get('password')?.touched">
            La contrase√±a es obligatoria
          </div>
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" id="available" formControlName="available" />
            <span class="checkmark"></span>
            <span class="checkbox-text">M√©dico disponible para citas</span>
          </label>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="!doctorForm.valid">
          <i class="icon-save"></i> {{ isEditing ? 'Actualizar M√©dico' : 'Registrar M√©dico' }}
        </button>
        <button type="button" class="btn btn-secondary" (click)="resetForm()" *ngIf="isEditing">
          <i class="icon-cancel"></i> Cancelar
        </button>
      </div>
    </form>
  </div>
</div>

<!-- üìã Lista de m√©dicos -->
<div class="doctors-list-section">
  <h3>Lista de M√©dicos Registrados</h3>
  <div class="table-responsive">
    <table class="doctors-table">
      <thead>
        <tr>
          <th><i class="icon-user"></i> Nombre</th>
          <th><i class="icon-stethoscope"></i> Especialidad</th>
          <th><i class="icon-mail"></i> Email</th>
          <th><i class="icon-phone"></i> Tel√©fono</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let doctor of doctors">
          <td>{{ doctor.name }}</td>
          <td>{{ doctor.specialty }}</td>
          <td>{{ doctor.email }}</td>
          <td>{{ doctor.phone }}</td>
          <td>
            <span class="status-badge" [class.available]="doctor.available" [class.unavailable]="!doctor.available">
              {{ doctor.available ? 'Disponible' : 'No disponible' }}
            </span>
          </td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-primary btn-sm" (click)="editDoctor(doctor)" title="Editar m√©dico">
                <i class="icon-edit"></i> Editar
              </button>
              <button class="btn btn-secondary btn-sm" (click)="openScheduleModal(doctor.id!)" title="Configurar horarios">
                <i class="icon-schedule"></i> Horarios
              </button>
              <button class="btn btn-warning btn-sm" (click)="openPermissionsModal(doctor)" title="Gestionar permisos">
                <i class="icon-permission"></i> Permisos
              </button>
              <button class="btn btn-danger btn-sm" (click)="deleteDoctor(doctor.id!)" title="Eliminar m√©dico">
                <i class="icon-delete"></i> Eliminar
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal de horarios laborales -->
<app-work-schedule-modal #scheduleModal></app-work-schedule-modal>

<!-- Modal de permisos -->
<app-doctor-permissions-modal #permissionsModal></app-doctor-permissions-modal>
